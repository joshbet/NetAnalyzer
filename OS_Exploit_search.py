#!/usr/bin/python3

import platform
from urllib.request import Request, urlopen
import ssl
from bs4 import BeautifulSoup
from html.parser import HTMLParser


class MyHTMLParser(HTMLParser):
    def handle_starttag(self, tag, attrs):
        print("Encountered a start tag:", tag)

    def handle_endtag(self, tag):
        print("Encountered an end tag :", tag)

    def handle_data(self, data):
        print("Encountered some data  :", data)

#Bypass for SSL when scraping website
ctx = ssl.create_default_context()
ctx.check_hostname = False
ctx.verify_mode = ssl.CERT_NONE

#Checks users exact OS and saves it as a variable
os = platform.platform()

#Define url for searching before terms are added
baseurl = 'https://www.exploit-db.com/search?platform='

#Displays users current version of their os
print(os)

if 'mac' in os.lower():
    print('This system is running macOS')
    useros = 'macos'
if 'windows' in os.lower():
    print('This system is running Windows')
    useros = 'windows'

if 'linux' in os.lower():
    print('This system is running Linux')
    useros = 'linux'


#Creates new URL for searching by combing the base URL and the users OS    
newurl = baseurl + useros

#Requests and opens the URL then gets the HTML from the page
req = Request(newurl, headers={'User-Agent': 'XYZ/3.0'})
webpage = urlopen(req, timeout=10, context=ctx).read()
htmlpage = webpage.decode("utf8")


#Used for parsing HTML
parser = MyHTMLParser()
parser.feed(htmlpage)

#print(htmlpage)


